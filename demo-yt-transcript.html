<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>YT Transcript Demo | Ryttr</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 2rem; background: #f9f9f9; }
    h1 { color: #333; }
    textarea, input { width: 100%; padding: 10px; margin: 10px 0; }
    button { padding: 10px 20px; background: #0070f3; color: white; border: none; cursor: pointer; }
    button:hover { background: #0051a3; }
    pre { white-space: pre-wrap; background: #fff; padding: 1rem; border: 1px solid #ddd; }
  </style>
</head>
<body>
  <h1>🎥 YouTube Transcript Demo</h1>
  <p>Paste a YouTube URL and get a cleaned transcript. Powered by Ryttr.</p>

  <input id="ytUrl" placeholder="Enter YouTube link here" />
  <button onclick="getTranscript()">Run Transcript</button>

  <h2>Result:</h2>
  <pre id="output">No results yet…</pre>

  <script>
    // Your backend API
    const PY_SERVICE_URL = "https://ryttr-transcript-nuclear.onrender.com/transcript";
    const PY_SERVICE_KEY = "ryttr_super_secret_456_even_longer"; // must match Render

    async function getTranscript() {
      const url = document.getElementById("ytUrl").value.trim();
      const output = document.getElementById("output");

      if (!url) {
        output.textContent = "❌ Please enter a YouTube URL.";
        return;
      }

      output.textContent = "⏳ Processing, please wait…";

      try {
        const res = await fetch(PY_SERVICE_URL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            "x-api-key": PY_SERVICE_KEY
          },
          body: JSON.stringify({ url })
        });

        if (!res.ok) {
          output.textContent = "❌ Error: " + res.status + " " + res.statusText;
          return;
        }

        const data = await res.json();
        if (data.error) {
          output.textContent = "⚠️ " + data.error;
        } else {
          output.textContent = "✅ Done!\n\n" + data.full_text.slice(0, 2000) + (data.full_text.length > 2000 ? "...\n\n[truncated]" : "");
        }
      } catch (err) {
        output.textContent = "🚨 Failed to fetch: " + err.message;
      }
    }
  </script>
</body>
</html>
